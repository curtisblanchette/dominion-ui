<label [for]="id" *ngIf="label" [ngClass]="{ 'required' : required }">{{label}}</label>
<div tabindex="-1" class="fiiz-dropdown-button" [ngClass]="{ 'no-title': !title, 'disabled': disabled }">

  <ng-container [ngSwitch]="dropdownType">

    <fiiz-button class="full-width dropdown" [disabled]="disabled" size="{{size ? size : null}}" tabindex="-1">
      {{getDisplayValue()}}
      <i class="fa-solid fa-caret-down" style="margin-left: auto;"></i>
    </fiiz-button>

  </ng-container>

  <div #dropdownList class="fiiz-dropdown-button__content fiiz-dropdown-button-{{position}}" *ngIf="showDropDowns"
       @dropDownMenu [ngSwitch]="type">

    <ng-template [ngIf]="dropdownType === 'search'">
      <form [formGroup]="searchForm">
        <fiiz-input
          #searchInput
          formControlName="search"
          autocomplete="off"
          [disabled]="disabled"
          [autofocus]="true"
          (keyup)="onKeyUpEvent($event)"
          type="text"
          placeholder="Search..."
          class="search"
          id="search-dropdown"
        ></fiiz-input>
      </form>
      <div class="fiiz-dropdown-button__content__wrapper">
        <ng-template *ngIf="!(loadingSubject$ | async)">
          <fiiz-loading type="ripple"></fiiz-loading>
        </ng-template>

        <fiiz-button
          *ngIf="required == false"
          tabindex="-1"
          class="dropdown"
          (click)="setTheValue(null)"
          style="border-radius: 0;">
        --None--
        </fiiz-button>
        <fiiz-button tabindex="-1"
           *ngFor="let item of items$ | async; let i = index; let last = last; "
           [ngClass]="{'selected': multiselect ? isPreselected(item.id) : currentIndex === i, 'dropdown': true, 'divider':!last}"
           (click)="setTheValue(item.id, item.label)"
           [disabled]="disabled"
           style="border-radius: 0;">
          <i class="fa" [ngClass]="{'fa-square': multiselect, 'fa-square-check': multiselect && isPreselected(item.id) }" *ngIf="multiselect"></i>
          {{ item.label }}
        </fiiz-button>

      </div>
    </ng-template>

    <ng-template [ngIf]="dropdownType === 'button'">

        <fiiz-button class="dropdown" tabindex="-1" *ngFor="let item of items$ | async; let i = index; let last = last" [ngClass]="{'divider': !last}" (click)="emitTheValue(item.emitterValue)">
          <i [class]="item.icon"></i> {{ item.label }}
        </fiiz-button>

    </ng-template>

    <ng-template [ngIf]="dropdownType === 'anchor'">
      <div *ngFor="let item of items$ | async; let i = index; let last = last " [ngClass]="{'divider': !last}">
        <a routerLink="item.path">
          <i [class]="item.icon"></i> {{ item.label }}
        </a>
      </div>
    </ng-template>

  </div>
</div>
