<ng-container [ngTemplateOutlet]="getTemplate() || loadingTemplate" [ngTemplateOutletContext]="{loadingText: loadingMessage}"></ng-container>

<ng-template #loginTemplate>
  <form [formGroup]="loginForm" (ngSubmit)="login()" data-qa="login-form" id="login-form">
    <svg width="140" viewBox="0 0 168 75" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
      <g id="Page-2" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="4iiz-brand-guidelines" transform="translate(-215.000000, -443.000000)" fill="#FFFFFF">
          <g id="Group-2" transform="translate(200.000000, 428.000000)">
            <path d="M117.7514,39.261 C114.8874,39.261 112.2594,38.645 110.1784,37.62 L110.1484,37.62 L110.1484,89.999 L125.3544,89.999 L125.3544,37.62 L125.3244,37.62 C123.2434,38.645 120.6154,39.261 117.7514,39.261" id="Fill-1193"></path>
            <polygon id="Fill-1195" points="182.766 37.6203 136.451 37.6203 136.451 48.7433 159.57 48.7433 132.285 89.9983 181.213 89.9983 181.213 78.8753 155.575 78.8753"></polygon>
            <path d="M51.2602,62.988 L32.6272,62.988 L51.2602,39.263 L51.2602,62.988 Z M66.4652,17.412 L50.9192,17.412 L15.6432,62.988 L15.6432,75.458 L51.2602,75.458 L51.2602,89.999 L66.4652,89.999 L66.4652,75.458 L73.7172,75.458 L73.7172,62.988 L66.4652,62.988 L66.4652,17.412 Z" id="Fill-1197"></path>
            <path d="M90.5229,39.2732 C87.6459,39.2732 85.0059,38.6532 82.9199,37.6222 L82.9199,89.9992 L98.1259,89.9992 L98.1259,37.6222 C96.0389,38.6532 93.3989,39.2732 90.5229,39.2732" id="Fill-1199"></path>
            <path d="M124.6157,18.091 C122.7037,16.431 120.4127,15.593 117.7617,15.593 C115.0917,15.593 112.8187,16.415 110.9257,18.042 C110.1337,18.736 109.5207,19.493 109.0637,20.306 C108.8607,20.664 108.5107,20.868 108.2907,20.832 C107.4847,20.68 105.9587,20.446 104.1677,20.446 C102.3717,20.446 100.8207,20.681 100.0047,20.833 C99.7137,20.895 99.3837,20.597 99.1867,20.263 C98.7347,19.485 98.1407,18.758 97.3867,18.091 C95.4737,16.431 93.1827,15.593 90.5327,15.593 C87.8617,15.593 85.5907,16.415 83.6967,18.042 C81.8217,19.685 80.8757,21.656 80.8757,23.973 C80.8757,26.371 81.8217,28.425 83.7337,30.101 C85.6277,31.793 87.9377,32.632 90.6457,32.632 C93.2587,32.632 95.5117,31.81 97.4057,30.151 C98.6837,29.041 99.5227,27.766 99.9317,26.332 C100.2017,25.421 100.9407,23.875 104.1657,23.875 C107.3887,23.875 108.1957,25.421 108.4787,26.445 C108.9187,27.812 109.7447,29.033 110.9637,30.101 C112.8567,31.793 115.1667,32.632 117.8747,32.632 C120.4877,32.632 122.7407,31.81 124.6347,30.151 C126.5277,28.508 127.4557,26.503 127.4557,24.153 C127.4557,21.788 126.5097,19.767 124.6157,18.091" id="Fill-1201"></path>
            <path d="M97.4057,24.1125 C97.4057,27.4465 94.3237,30.1505 90.5227,30.1505 C86.7207,30.1505 83.6387,27.4465 83.6387,24.1125 C83.6387,20.7775 86.7207,18.0745 90.5227,18.0745 C94.3237,18.0745 97.4057,20.7775 97.4057,24.1125" id="Fill-1203"></path>
            <path d="M124.6342,24.1125 C124.6342,27.4465 121.5532,30.1505 117.7512,30.1505 C113.9492,30.1505 110.8682,27.4465 110.8682,24.1125 C110.8682,20.7775 113.9492,18.0745 117.7512,18.0745 C121.5532,18.0745 124.6342,20.7775 124.6342,24.1125" id="Fill-1205"></path>
          </g>
        </g>
      </g>
    </svg>

    <fiiz-input
      #username
      id="username"
      formControlName="username"
      type="text"
      required
      [autofocus]="true"
      placeholder="Username">
    </fiiz-input>

    <fiiz-input
      id="password"
      formControlName="password"
      placeholder="Password"
      type="password"
      required
      minlength="12">
    </fiiz-input>

    <fiiz-button primary class="full-width" type="submit" [loading]="isLoading$" [disabled]="(isLoading$ | async) || loginForm.invalid">Let's Go!</fiiz-button>
<!--    <input type="submit" class="primary large" value="Let's Go!" [disabled]="isLoading$ | async">-->

    <!-- <button class="forgot-password transparent large" type="button" (click)="updateShowForm('forgot-password')">Forgot password?</button> -->
    <div style="color:red; margin: 0 0 0 54px;" *ngIf="error$ | async">{{errorMessage}}</div>
  </form>
</ng-template>

<ng-template #newUserTemplate>
  <form (ngSubmit)="acceptInvitation()" [formGroup]="newUserForm" id="new-user-form" name="new-user-form">

    <ng-container [ngTemplateOutlet]="(isLoading$ | async) ? loadingTemplate : newUserTemplate" [ngTemplateOutletContext]="{loadingText: 'Checking Invitation...'}"></ng-container>

    <ng-template #newUserTemplate>
      <h2>New User</h2>

      <fiiz-input
        id="email"
        formControlName="email"
        type="text"
        label="Email"
        placeholder="Email Address">
      </fiiz-input>

      <fiiz-input
        id="firstName"
        formControlName="firstName"
        type="text"
        label="First Name"
        placeholder="First Name">
      </fiiz-input>

      <fiiz-input
        id="lastName"
        formControlName="lastName"
        type="text"
        label="Last Name"
        placeholder="Last Name">
      </fiiz-input>

      <fiiz-input
        id="password"
        formControlName="password"
        type="password"
        label="Password"
        placeholder="Password"
        required
        minlength="12">
      </fiiz-input>

      <fiiz-input
        id="confirmPassword"
        formControlName="confirmPassword"
        type="password"
        label="Confirm Password"
        placeholder="Confirm Password"
        required
        minlength="12">
      </fiiz-input>

      <fiiz-button primary class="full-width" type="submit" [loading]="isLoading$" [disabled]="(isLoading$ | async) || newUserForm.invalid">Complete Registration</fiiz-button>

    </ng-template>


  </form>
</ng-template>



<ng-template #loadingTemplate let-loadingText="loadingText">
  <div class="loader">
    <fiiz-loading>{{loadingText}}</fiiz-loading>
  </div>
</ng-template>


