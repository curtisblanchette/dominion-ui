<div class="flow-layout">
  <div class="flow-layout__main">

    <section class="flow-layout__sidebar">
      <div style="padding: 30px;">
        <fiiz-tab-nav [items]="[{key: 'timeline', label: 'Timeline'}, {key: 'notes', label: 'Notes'}]" (onSelect)="$event === 'timeline' ? tabIndex = 1 : tabIndex = 0 "></fiiz-tab-nav>
        <ng-container *ngTemplateOutlet="tabIndex ? flowTimeline : flowNotes"></ng-container>
      </div>
    </section>
    <section class="fab-button">
      <fiiz-dropdown
        type = "button"
        [items] = "menuItems"
        position = "bottom-right"
      ></fiiz-dropdown>
    </section>
    <section [@slide]="animationIndex" class="flow-layout__content">
      <ng-template flowHost></ng-template>
<!--      <router-outlet  name="flow" #outlet></router-outlet>-->
      <div class="flow-layout__controls">
        <fiiz-button (click)="onBack($event)" stroked *ngIf="(stepHistory$ | async)?.length > 0">Back</fiiz-button>
        <fiiz-button type="submit" [disabled]="!(valid$ | async)" primary (click)="onNext($event)" style="margin-left: auto;">Next</fiiz-button>
      </div>
    </section>

  </div>
</div>

<ng-template #flowTimeline>
  <flow-timeline (onSelect)="goTo($event)"></flow-timeline>
</ng-template>

<ng-template #flowNotes>
  <div>
    <editor
      apiKey="urnz0s9a4al78qoc2vppvb448lleii59pbarcr4cgviahk1i"
      outputFormat="html"
      [initialValue]="(notes$ | async)"
      (onSelectionChange)="saveNotes($event)"
      [(ngModel)]="notesData"
      [init]="tinymceOptions"
    ></editor>
  </div>
</ng-template>
