<div class="flow-layout">
  <div class="flow-layout__main">

    <section class="flow-layout__sidebar">
      <fiiz-tab-nav [items]="[{key: 'notes', label: 'Notes'}, {key: 'timeline', label: 'Timeline'}]" (onSelect)="$event === 'notes' ? tabIndex = 1 : tabIndex = 0 "></fiiz-tab-nav>
      <ng-container *ngTemplateOutlet="tabIndex ? flowNotes : flowTimeline"></ng-container>
      <fiiz-button>Objection</fiiz-button>
      <fiiz-button>End Call</fiiz-button>
    </section>
    <section class="fab-button">

      <fiiz-dropdown type="button" (onClick)="handleFabAction($event)" [items]="menuItems" position="bottom-right">Objections</fiiz-dropdown>
    </section>
    <section [@slide]="animationIndex" class="flow-layout__content">

      <div style="left: 30px; right: 30px; top: 0; bottom:0;">
        <ng-template flowHost></ng-template>
        <!--      <router-outlet  name="flow" #outlet></router-outlet>-->
        <div class="flow-layout__controls">
          <fiiz-button (click)="onBack($event)" stroked *ngIf="(stepHistory$ | async)?.length > 0">Back</fiiz-button>
          <fiiz-button type="submit" [disabled]="!(valid$ | async)" primary (click)="onNext($event)" style="margin-left: auto;">Next</fiiz-button>
        </div>
      </div>

    </section>

  </div>
</div>

<ng-template #flowNotes>
  <div>
    <editor
      apiKey="urnz0s9a4al78qoc2vppvb448lleii59pbarcr4cgviahk1i"
      outputFormat="html"
      [initialValue]="(notes$ | async)"
      (onSelectionChange)="saveNotes($event)"
      [(ngModel)]="notesData"
      [init]="tinymceOptions"
    ></editor>
  </div>
</ng-template>

<ng-template #flowTimeline>
  <flow-timeline (onSelect)="goTo($event)"></flow-timeline>
</ng-template>
