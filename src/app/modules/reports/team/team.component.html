<div class="team__wrapper">
  <div class="team__filters">
    <form [formGroup]="form" class="report-filters" *ngIf="form">
      <fiiz-date-picker
        #startDate
        [pickerType]="'calendar'"
        [id]="'filter_start_date'"
        [label]="'START DATE'"
        [max]="today"
        [formControlName]="'startDate'"
        [placeholder]="'Start Date'"
      ></fiiz-date-picker>
      <fiiz-date-picker
        #endDate
        [pickerType]="'calendar'"
        [id]="'filter_end_date'"
        [label]="'END DATE'"
        [formControlName]="'endDate'"
        [placeholder]="'End Date'"
        [min]="startDate.value"
        [max]="today"
      ></fiiz-date-picker>
    </form>
  </div>

  <div class="team__reports" *ngIf="(status$ | async) === 'success'">

    <fiiz-tab-nav (onSelect)="goTo($event)" [items]="[{key: 'inbound', label: 'Inbound Sales'}, {key: 'outbound', label: 'Outbound Sales'}, {key: 'consultations', label: 'Consultations'}]">
    </fiiz-tab-nav>

    <h5>All {{agentOrConsultant}}s</h5>

    <nav class="pipeline-nav">
      <section class="pipeline-nav__section" style="flex:0.4; margin-right: 20px;" *ngFor="let stat of teamStats[activePath]; let i = index">
        <div class="pipeline-nav__item">
          <div class="pipeline-nav__item__title">{{stat.label}}</div>
          <div class="pipeline-nav__item__metric"><span [countUp]="stat.value"></span><span class="supporting-metric" *ngIf="stat.label === 'Answers/Calls' && activePath === 'outbound'">/{{(data$ | async)[activePath].calls}}</span></div>
          <div class="pipeline-nav__item__caption">&nbsp;</div>
        </div>
      </section>
    </nav>

    <h5>Breakdown by {{agentOrConsultant}}</h5>
    <fiiz-grid [cols]="columns[activePath]?.length + 1" class="table">
      <div  class="table-heading" style="color: #64738E;font-size: 12px;cursor: pointer; text-align: center;" (click)="sortField('name')">Name <i class="fa {{currentSort[1] === 'name' ? sortStates[currentSort[0]].iconClass : ''}}"></i></div>
      <div  class="table-heading" *ngFor="let column of columns[activePath]" style="color: #64738E;font-size: 12px;cursor: pointer; text-align: center;" (click)="sortField(column)">{{getLabel(column, 'table')}} <i class="fa {{currentSort[1] === column ? sortStates[currentSort[0]].iconClass : ''}}"></i></div>
      <ng-container *ngFor="let person of people[activePath]">
        <div data-column="name">{{person.name}}</div>
        <div [attr.data-column]="column" *ngFor="let column of columns[activePath]" style="text-align:center;">{{person[column]}}{{column.indexOf('Rate') === -1 ? '' : '%' }}</div>
      </ng-container>
    </fiiz-grid>

  </div>
</div>
